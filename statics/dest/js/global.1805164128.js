!function(e){"use strict";function n(e){return function(){return{request:function(n){return n.url=e+n.url,n}}}}function t(e,n,t){return function(r,o){if("development"===t.env)alert(r.message),e.error.apply(e,arguments);else{var i=n.get("$http");i.post("/exception?httplog=false",{message:r.message,stack:r.stack,cause:o})}}}function r(e,n,t,r,o){TIMING.end("js"),o=o("app.run");var i=function(){var n=angular.extend({timeline:TIMING.getLogs(),screen:{width:t.screen.width,height:t.screen.height,innerHeight:t.innerHeight,innerWidth:t.innerWidth}},t.performance);e.post("/sys/statistics",n)};if(t.onload=function(){i()},"development"===r.env){var s=1e4,u=function(){var e=0,t=function(n){if(n.data().hasOwnProperty("$scope")){var r=n.data().$scope.$$watchers;r&&(e+=r.length)}angular.forEach(n.children(),function(e){t(angular.element(e))})};t(angular.element(document.body)),o("watcher total:"+e),n(function(){u()},s)};n(function(){u()},u)}}function o(e,n,t,r,o){function i(n){var o=angular.element(angular.element("#loginDialog").html()),i=e.$new(!0);angular.extend(i,{status:"show",type:n,modal:!0}),t(o)(i),r.append(o),i.submit=function(){c(i)},angular.forEach(["account","password"],function(e){i.$watch(e,function(){i.error=""})})}function s(){i("login")}function u(){i("register")}function a(){o.logout()}function c(e){if(!e.account||!e.password)return void(e.error="账号和密码均不能为空");e.submiting=!0,e.msg="正在提交，请稍候...";var n=o[e.type];n&&n(e.account,e.password).success(function(){e.destroy()}).error(function(n){e.error=n.msg||n.error||"未知异常",e.submiting=!1,e.msg=""})}function l(){f.session.status="loading",o.session().then(function(e){angular.extend(f.session,e),f.session.status="success"},function(e){f.session.error=e,f.session.status="fail"})}var f=this;f.login=s,f.logout=a,f.register=u,f.session={},e.$on("user",function(e,n){l()}),l()}var i=["LocalStorageModule","jt.service.const","jt.service.debug","jt.service.httpLog","jt.service.user","jt.directive.widget"],s=angular.module("jtApp",i);s.addRequires=function(e){angular.isArray(e)||(e=[e]);var n=s.requires;return angular.forEach(e,function(e){~n.indexOf(e)||n.push(e)}),this},s.config(["localStorageServiceProvider",function(e){e.prefix="jt"}]).config(["$httpProvider","CONST",function(e,t){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";var r=t.appUrlPrefix;if(r){var o=n(r);e.interceptors.push(o)}e.interceptors.push("httpLog")}]).config(["$provide",function(e){var n=["$log","$injector","CONST",t];e.decorator("$exceptionHandler",n)}]),s.run(["$http","$timeout","$window","CONST","debug",r]),s.controller("AppController",o),o.$inject=["$scope","$http","$compile","$element","user"]}(this);